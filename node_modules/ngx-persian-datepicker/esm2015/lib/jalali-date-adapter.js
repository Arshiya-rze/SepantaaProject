/**
 * @fileoverview added by tsickle
 * Generated from: lib/jalali-date-adapter.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Inject, Optional } from '@angular/core';
import { DateAdapter } from '@angular/material';
import * as jMoment from 'moment-jalaali';
import { MAT_DATE_LOCALE } from './injectors';
/** @type {?} */
const minmin = jMoment;
export class JalaliMomentDateAdapter extends DateAdapter {
    /**
     * @param {?} matDateLocale
     */
    constructor(matDateLocale) {
        super();
        this.setLocale(matDateLocale || minmin.locale('fa'));
        minmin.loadPersian();
    }
    /**
     * @return {?}
     */
    invalid() {
        return (/** @type {?} */ ('hi'));
    }
    /**
     * @param {?} date
     * @return {?}
     */
    toIso8601(date) {
        return 'hi';
    }
    /**
     * returns year in jalali calendar system.
     * @param {?} date
     * @return {?}
     */
    getYear(date) {
        return this.clone(date).jYear();
    }
    /**
     * returns month in jalali calendar system.
     * @param {?} date
     * @return {?}
     */
    getMonth(date) {
        return this.clone(date).jMonth();
    }
    /**
     * returns day in jalali calendar system.
     * @param {?} date
     * @return {?}
     */
    getDate(date) {
        return this.clone(date).jDate();
    }
    /**
     * returns Day Of Week in jalali calendar system.
     * @param {?} date
     * @return {?}
     */
    getDayOfWeek(date) {
        return this.clone(date).day();
    }
    /**
     * returns Month Names in jalali calendar system.
     * most of the time we use long format. short or narrow format for month names is a little odd.
     * @param {?} style
     * @return {?}
     */
    getMonthNames(style) {
        /** @type {?} */
        const r = [];
        minmin.loadPersian({ dialect: 'persian', usePersianDigits: true });
        /** @type {?} */
        const l = minmin().localeData();
        if (style === 'long' || style === 'short') {
            Object.keys(l).forEach((/**
             * @param {?} key
             * @return {?}
             */
            key => {
                if (key === '_jMonths') {
                    /** @type {?} */
                    const values = l[key];
                    for (let index = 0; index < values.length; index++) {
                        r.push(values[index]);
                    }
                }
            }));
        }
        else {
            Object.keys(l).forEach((/**
             * @param {?} key
             * @return {?}
             */
            key => {
                if (key === '_jMonthsShort') {
                    /** @type {?} */
                    const values = l[key];
                    for (let index = 0; index < values.length; index++) {
                        r.push(values[index]);
                    }
                }
            }));
        }
        return r;
        // switch (style) {
        //     case 'long':
        //         const mlong = (minmin().localeData() as any)._jMonths.slice(0);
        //         console.log(mlong);
        //         return mlong;
        //     case 'short':
        //         const mshort = (minmin().localeData() as any)._jMonthsShort.slice(0);
        //         console.log('mshort: ', mshort);
        //         return mshort;
        //     case 'narrow':
        //         return (minmin().localeData() as any)._jMonthsShort.slice(0);
        // }
    }
    /**
     * borrowed from angular material code.
     * @return {?}
     */
    getDateNames() {
        return this.range(31, (/**
         * @param {?} i
         * @return {?}
         */
        i => String(i + 1)));
    }
    /**
     * returns Day Of Week names in jalali calendar system.
     * @param {?} style
     * @return {?}
     */
    getDayOfWeekNames(style) {
        switch (style) {
            case 'long':
                return minmin().localeData().weekdays().slice(0);
            case 'short':
                return minmin().localeData().weekdaysShort().slice(0);
            case 'narrow':
                return minmin().localeData().weekdaysMin().slice(0);
        }
    }
    /**
     * returns year in jalali calendar system.
     * @param {?} date
     * @return {?}
     */
    getYearName(date) {
        return this.clone(date).jYear().toString();
    }
    /**
     * returns first day of week in jalali calendar system.
     * first day of week is saturday, شنبه
     * @return {?}
     */
    getFirstDayOfWeek() {
        return 6;
    }
    /**
     * returns Number of Days In Month in jalali calendar system.
     * @param {?} date
     * @param {?=} fa
     * @return {?}
     */
    getNumDaysInMonth(date, fa) {
        if (date['_d']) {
            return minmin.jDaysInMonth(this.getYear(date['_d']), this.getMonth(date['_d']));
        }
        return minmin.jDaysInMonth(this.getYear(date), this.getMonth(date));
    }
    /**
     * @param {?} date
     * @return {?}
     */
    clone(date) {
        // return date.clone().locale(this.locale);
        return minmin(date);
    }
    /**
     * @param {?} year
     * @param {?} month
     * @param {?} date
     * @return {?}
     */
    createDate(year, month, date) {
        return minmin().jYear(year).jMonth(month).jDate(date);
    }
    /**
     * @return {?}
     */
    today() {
        return minmin();
    }
    /**
     * @param {?} value
     * @param {?} parseFormat
     * @return {?}
     */
    parse(value, parseFormat) {
        if (value && typeof value === 'string') {
            return minmin(value, parseFormat, this.locale);
        }
        return value ? minmin(value).locale(this.locale) : null;
    }
    /**
     * @param {?} date
     * @param {?} displayFormat
     * @return {?}
     */
    format(date, displayFormat) {
        return this.clone(date).format(displayFormat);
    }
    /**
     * @param {?} date
     * @param {?} years
     * @return {?}
     */
    addCalendarYears(date, years) {
        return this.clone(date).add(years, 'jYear');
    }
    /**
     * @param {?} date
     * @param {?} months
     * @return {?}
     */
    addCalendarMonths(date, months) {
        return this.clone(date).add((/** @type {?} */ (months)), 'jmonth');
    }
    /**
     * @param {?} date
     * @param {?} days
     * @return {?}
     */
    addCalendarDays(date, days) {
        return this.clone(date).add(days, 'day');
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getISODateString(date) {
        return this.clone(date).format('jYYYY-jMM-jDD');
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    isDateInstance(obj) {
        return minmin.isMoment(obj);
    }
    /**
     * @param {?} date
     * @return {?}
     */
    isValid(date) {
        return this.clone(date).isValid();
    }
    /**
     * @template T
     * @param {?} length
     * @param {?} valueFunction
     * @return {?}
     */
    range(length, valueFunction) {
        /** @type {?} */
        const valuesArray = Array(length);
        for (let i = 0; i < length; i++) {
            valuesArray[i] = valueFunction(i);
        }
        return valuesArray;
    }
}
/** @nocollapse */
JalaliMomentDateAdapter.ctorParameters = () => [
    { type: String, decorators: [{ type: Optional }, { type: Inject, args: [MAT_DATE_LOCALE,] }] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamFsYWxpLWRhdGUtYWRhcHRlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1wZXJzaWFuLWRhdGVwaWNrZXIvIiwic291cmNlcyI6WyJsaWIvamFsYWxpLWRhdGUtYWRhcHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBQyxNQUFNLEVBQUUsUUFBUSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQy9DLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUM5QyxPQUFPLEtBQUssT0FBTyxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxhQUFhLENBQUM7O01BQ3RDLE1BQU0sR0FBUSxPQUFPO0FBRzNCLE1BQU0sT0FBTyx1QkFBd0IsU0FBUSxXQUEyQjs7OztJQUN0RSxZQUFpRCxhQUFxQjtRQUNwRSxLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNyRCxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDdkIsQ0FBQzs7OztJQUVELE9BQU87UUFDTCxPQUFPLG1CQUFBLElBQUksRUFBTyxDQUFDO0lBRXJCLENBQUM7Ozs7O0lBRUQsU0FBUyxDQUFDLElBQUk7UUFDWixPQUFPLElBQUksQ0FBQztJQUVkLENBQUM7Ozs7OztJQUtELE9BQU8sQ0FBQyxJQUFvQjtRQUMxQixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDbEMsQ0FBQzs7Ozs7O0lBS0QsUUFBUSxDQUFDLElBQW9CO1FBQzNCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNuQyxDQUFDOzs7Ozs7SUFLRCxPQUFPLENBQUMsSUFBb0I7UUFDMUIsT0FBTyxJQUFJLENBQUMsS0FB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LE1BQU0sQ0FBQztRQUNqQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQy9CLFdBQVcsQ0FBQyxDQUFDLENBQUMsR0FBRyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbkM7UUFDRCxPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDOzs7O3lDQTFMWSxRQUFRLFlBQUksTUFBTSxTQUFDLGVBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdCwgT3B0aW9uYWx9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge0RhdGVBZGFwdGVyfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbCc7XHJcbmltcG9ydCAqIGFzIGpNb21lbnQgZnJvbSAnbW9tZW50LWphbGFhbGknO1xyXG5pbXBvcnQge01BVF9EQVRFX0xPQ0FMRX0gZnJvbSAnLi9pbmplY3RvcnMnO1xyXG5jb25zdCBtaW5taW46IGFueSA9IGpNb21lbnQ7XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEphbGFsaU1vbWVudERhdGVBZGFwdGVyIGV4dGVuZHMgRGF0ZUFkYXB0ZXI8ak1vbWVudC5Nb21lbnQ+IHtcclxuICBjb25zdHJ1Y3RvcihAT3B0aW9uYWwoKSBASW5qZWN0KE1BVF9EQVRFX0xPQ0FMRSkgbWF0RGF0ZUxvY2FsZTogc3RyaW5nKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5zZXRMb2NhbGUobWF0RGF0ZUxvY2FsZSB8fCBtaW5taW4ubG9jYWxlKCdmYScpKTtcclxuICAgIG1pbm1pbi5sb2FkUGVyc2lhbigpO1xyXG4gIH1cclxuXHJcbiAgaW52YWxpZCgpIHtcclxuICAgIHJldHVybiAnaGknIGFzIGFueTtcclxuXHJcbiAgfVxyXG5cclxuICB0b0lzbzg2MDEoZGF0ZSkge1xyXG4gICAgcmV0dXJuICdoaSc7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmV0dXJucyB5ZWFyIGluIGphbGFsaSBjYWxlbmRhciBzeXN0ZW0uXHJcbiAgICovXHJcbiAgZ2V0WWVhcihkYXRlOiBqTW9tZW50Lk1vbWVudCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy5jbG9uZShkYXRlKS5qWWVhcigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmV0dXJucyBtb250aCBpbiBqYWxhbGkgY2FsZW5kYXIgc3lzdGVtLlxyXG4gICAqL1xyXG4gIGdldE1vbnRoKGRhdGU6IGpNb21lbnQuTW9tZW50KTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNsb25lKGRhdGUpLmpNb250aCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmV0dXJucyBkYXkgaW4gamFsYWxpIGNhbGVuZGFyIHN5c3RlbS5cclxuICAgKi9cclxuICBnZXREYXRlKGRhdGU6IGpNb21lbnQuTW9tZW50KTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNsb25lKGRhdGUpLmpEYXRlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiByZXR1cm5zIERheSBPZiBXZWVrIGluIGphbGFsaSBjYWxlbmRhciBzeXN0ZW0uXHJcbiAgICovXHJcbiAgZ2V0RGF5T2ZXZWVrKGRhdGU6IGpNb21lbnQuTW9tZW50KTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNsb25lKGRhdGUpLmRheSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmV0dXJucyBNb250aCBOYW1lcyBpbiBqYWxhbGkgY2FsZW5kYXIgc3lzdGVtLlxyXG4gICAqIG1vc3Qgb2YgdGhlIHRpbWUgd2UgdXNlIGxvbmcgZm9ybWF0LiBzaG9ydCBvciBuYXJyb3cgZm9ybWF0IGZvciBtb250aCBuYW1lcyBpcyBhIGxpdHRsZSBvZGQuXHJcbiAgICovXHJcbiAgZ2V0TW9udGhOYW1lcyhzdHlsZTogJ2xvbmcnIHwgJ3Nob3J0JyB8ICduYXJyb3cnKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3Qgcjogc3RyaW5nW10gPSBbXTtcclxuICAgIG1pbm1pbi5sb2FkUGVyc2lhbih7ZGlhbGVjdDogJ3BlcnNpYW4nLCB1c2VQZXJzaWFuRGlnaXRzOiB0cnVlfSk7XHJcbiAgICBjb25zdCBsID0gbWlubWluKCkubG9jYWxlRGF0YSgpO1xyXG4gICAgaWYgKHN0eWxlID09PSAnbG9uZycgfHwgc3R5bGUgPT09ICdzaG9ydCcpIHtcclxuICAgICAgT2JqZWN0LmtleXMobCkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIGlmIChrZXkgPT09ICdfak1vbnRocycpIHtcclxuICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IGxba2V5XTtcclxuICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB2YWx1ZXMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgIHIucHVzaCh2YWx1ZXNbaW5kZXhdKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgT2JqZWN0LmtleXMobCkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgIGlmIChrZXkgPT09ICdfak1vbnRoc1Nob3J0Jykge1xyXG4gICAgICAgICAgY29uc3QgdmFsdWVzID0gbFtrZXldO1xyXG4gICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHZhbHVlcy5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICAgICAgci5wdXNoKHZhbHVlc1tpbmRleF0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcjtcclxuICAgIC8vIHN3aXRjaCAoc3R5bGUpIHtcclxuICAgIC8vICAgICBjYXNlICdsb25nJzpcclxuICAgIC8vICAgICAgICAgY29uc3QgbWxvbmcgPSAobWlubWluKCkubG9jYWxlRGF0YSgpIGFzIGFueSkuX2pNb250aHMuc2xpY2UoMCk7XHJcbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKG1sb25nKTtcclxuICAgIC8vICAgICAgICAgcmV0dXJuIG1sb25nO1xyXG4gICAgLy8gICAgIGNhc2UgJ3Nob3J0JzpcclxuICAgIC8vICAgICAgICAgY29uc3QgbXNob3J0ID0gKG1pbm1pbigpLmxvY2FsZURhdGEoKSBhcyBhbnkpLl9qTW9udGhzU2hvcnQuc2xpY2UoMCk7XHJcbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKCdtc2hvcnQ6ICcsIG1zaG9ydCk7XHJcbiAgICAvLyAgICAgICAgIHJldHVybiBtc2hvcnQ7XHJcbiAgICAvLyAgICAgY2FzZSAnbmFycm93JzpcclxuICAgIC8vICAgICAgICAgcmV0dXJuIChtaW5taW4oKS5sb2NhbGVEYXRhKCkgYXMgYW55KS5fak1vbnRoc1Nob3J0LnNsaWNlKDApO1xyXG4gICAgLy8gfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogYm9ycm93ZWQgZnJvbSBhbmd1bGFyIG1hdGVyaWFsIGNvZGUuXHJcbiAgICovXHJcbiAgZ2V0RGF0ZU5hbWVzKCk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiB0aGlzLnJhbmdlKDMxLCBpID0+IFN0cmluZyhpICsgMSkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmV0dXJucyBEYXkgT2YgV2VlayBuYW1lcyBpbiBqYWxhbGkgY2FsZW5kYXIgc3lzdGVtLlxyXG4gICAqL1xyXG4gIGdldERheU9mV2Vla05hbWVzKHN0eWxlOiAnbG9uZycgfCAnc2hvcnQnIHwgJ25hcnJvdycpOiBzdHJpbmdbXSB7XHJcbiAgICBzd2l0Y2ggKHN0eWxlKSB7XHJcbiAgICAgIGNhc2UgJ2xvbmcnOlxyXG4gICAgICAgIHJldHVybiBtaW5taW4oKS5sb2NhbGVEYXRhKCkud2Vla2RheXMoKS5zbGljZSgwKTtcclxuICAgICAgY2FzZSAnc2hvcnQnOlxyXG4gICAgICAgIHJldHVybiBtaW5taW4oKS5sb2NhbGVEYXRhKCkud2Vla2RheXNTaG9ydCgpLnNsaWNlKDApO1xyXG4gICAgICBjYXNlICduYXJyb3cnOlxyXG4gICAgICAgIHJldHVybiBtaW5taW4oKS5sb2NhbGVEYXRhKCkud2Vla2RheXNNaW4oKS5zbGljZSgwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJldHVybnMgeWVhciBpbiBqYWxhbGkgY2FsZW5kYXIgc3lzdGVtLlxyXG4gICAqL1xyXG4gIGdldFllYXJOYW1lKGRhdGU6IGpNb21lbnQuTW9tZW50KTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmNsb25lKGRhdGUpLmpZZWFyKCkudG9TdHJpbmcoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJldHVybnMgZmlyc3QgZGF5IG9mIHdlZWsgaW4gamFsYWxpIGNhbGVuZGFyIHN5c3RlbS5cclxuICAgKiBmaXJzdCBkYXkgb2Ygd2VlayBpcyBzYXR1cmRheSwg2LTZhtio2YdcclxuICAgKi9cclxuICBnZXRGaXJzdERheU9mV2VlaygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIDY7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiByZXR1cm5zIE51bWJlciBvZiBEYXlzIEluIE1vbnRoIGluIGphbGFsaSBjYWxlbmRhciBzeXN0ZW0uXHJcbiAgICovXHJcbiAgZ2V0TnVtRGF5c0luTW9udGgoZGF0ZTogak1vbWVudC5Nb21lbnQsIGZhPyk6IG51bWJlciB7XHJcbiAgICBpZiAoZGF0ZVsnX2QnXSkge1xyXG4gICAgICByZXR1cm4gbWlubWluLmpEYXlzSW5Nb250aCh0aGlzLmdldFllYXIoZGF0ZVsnX2QnXSksIHRoaXMuZ2V0TW9udGgoZGF0ZVsnX2QnXSkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG1pbm1pbi5qRGF5c0luTW9udGgodGhpcy5nZXRZZWFyKGRhdGUpLCB0aGlzLmdldE1vbnRoKGRhdGUpKTtcclxuICB9XHJcblxyXG4gIGNsb25lKGRhdGU6IGpNb21lbnQuTW9tZW50KTogak1vbWVudC5Nb21lbnQge1xyXG4gICAgLy8gcmV0dXJuIGRhdGUuY2xvbmUoKS5sb2NhbGUodGhpcy5sb2NhbGUpO1xyXG4gICAgcmV0dXJuIG1pbm1pbihkYXRlKTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZURhdGUoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyLCBkYXRlOiBudW1iZXIpOiBqTW9tZW50Lk1vbWVudCB7XHJcbiAgICByZXR1cm4gbWlubWluKCkualllYXIoeWVhcikuak1vbnRoKG1vbnRoKS5qRGF0ZShkYXRlKTtcclxuICB9XHJcblxyXG4gIHRvZGF5KCk6IGpNb21lbnQuTW9tZW50IHtcclxuICAgIHJldHVybiBtaW5taW4oKTtcclxuICB9XHJcblxyXG4gIHBhcnNlKHZhbHVlOiBhbnksIHBhcnNlRm9ybWF0OiBzdHJpbmcgfCBzdHJpbmdbXSk6IGpNb21lbnQuTW9tZW50IHwgbnVsbCB7XHJcbiAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICByZXR1cm4gbWlubWluKHZhbHVlLCBwYXJzZUZvcm1hdCwgdGhpcy5sb2NhbGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlID8gbWlubWluKHZhbHVlKS5sb2NhbGUodGhpcy5sb2NhbGUpIDogbnVsbDtcclxuICB9XHJcblxyXG4gIGZvcm1hdChkYXRlOiBqTW9tZW50Lk1vbWVudCwgZGlzcGxheUZvcm1hdDogYW55KTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmNsb25lKGRhdGUpLmZvcm1hdChkaXNwbGF5Rm9ybWF0KTtcclxuICB9XHJcblxyXG4gIGFkZENhbGVuZGFyWWVhcnMoZGF0ZTogak1vbWVudC5Nb21lbnQsIHllYXJzOiBudW1iZXIpOiBqTW9tZW50Lk1vbWVudCB7XHJcbiAgICByZXR1cm4gdGhpcy5jbG9uZShkYXRlKS5hZGQoeWVhcnMsICdqWWVhcicpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FsZW5kYXJNb250aHMoZGF0ZTogak1vbWVudC5Nb21lbnQsIG1vbnRoczogbnVtYmVyKTogak1vbWVudC5Nb21lbnQge1xyXG4gICAgcmV0dXJuIHRoaXMuY2xvbmUoZGF0ZSkuYWRkKG1vbnRocyBhcyBhbnksICdqbW9udGgnKTtcclxuICB9XHJcblxyXG4gIGFkZENhbGVuZGFyRGF5cyhkYXRlOiBqTW9tZW50Lk1vbWVudCwgZGF5czogbnVtYmVyKTogak1vbWVudC5Nb21lbnQge1xyXG4gICAgcmV0dXJuIHRoaXMuY2xvbmUoZGF0ZSkuYWRkKGRheXMsICdkYXknKTtcclxuICB9XHJcblxyXG4gIGdldElTT0RhdGVTdHJpbmcoZGF0ZTogak1vbWVudC5Nb21lbnQpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuY2xvbmUoZGF0ZSkuZm9ybWF0KCdqWVlZWS1qTU0takREJyk7XHJcbiAgfVxyXG5cclxuICBpc0RhdGVJbnN0YW5jZShvYmo6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIG1pbm1pbi5pc01vbWVudChvYmopO1xyXG4gIH1cclxuXHJcbiAgaXNWYWxpZChkYXRlOiBqTW9tZW50Lk1vbWVudCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY2xvbmUoZGF0ZSkuaXNWYWxpZCgpO1xyXG4gIH1cclxuXHJcbiAgcmFuZ2U8VD4obGVuZ3RoOiBudW1iZXIsIHZhbHVlRnVuY3Rpb246IChpbmRleDogbnVtYmVyKSA9PiBUKTogVFtdIHtcclxuICAgIGNvbnN0IHZhbHVlc0FycmF5ID0gQXJyYXkobGVuZ3RoKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgdmFsdWVzQXJyYXlbaV0gPSB2YWx1ZUZ1bmN0aW9uKGkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlc0FycmF5O1xyXG4gIH1cclxufVxyXG4iXX0=